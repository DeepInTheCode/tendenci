{% extends "site_base.html" %}
{% load styled_forms %}
{% load forms_tags %}
{% load i18n %}

{% block title %}{{ block.super }} Contact Us{% endblock %}

{% block extra_head %}
{{ block.super }}
<link rel="stylesheet" href="{{ STATIC_URL }}css/forms.css">
{% endblock %}

{% block body %}
<div class="t">
{% if SITE_GLOBAL_CONTACT_FORM %}
    {% embed_form SITE_GLOBAL_CONTACT_FORM "forms/contact_form.html" %}
{% else %}
    <h1>{% trans "Contact Us" %}</h1>

    <div class="contact-form-wrap">
    
        {% blocktrans %}
        <p>Please fill out the form below.</p>
        {% endblocktrans %}

        <form action="{% url form %}" method="post">{% csrf_token %}
        <div class="forms">
            {{ form|styled_form }}
            <input type="submit" value="Contact {{ SITE_GLOBAL_SITEDISPLAYNAME|capfirst }}" />
        </div>
        </form>
    </div>
{% endif %}
</div>
{% endblock %}
{% block extra_body %}
    {{ block.super }}
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-ui-1.8.20.custom.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/email-verification.js"></script>
    <script type="text/javascript">
        $( ".modal-form-wrap" ).dialog({
            autoOpen: false,
            height: 400,
            width: 500,
            modal: true,
            position: "center",
            title: "Confirm Form",
            resizable: false,
        });
        // check if captcha field exists in the form
        if ($(".form-field div.id_captcha").parents("div.embed-form form").length == 1){
            $("div.embed-form form .form-field div.id_captcha").hide();
            $("div.embed-form form").submit(function(){
                $(".modal-form-wrap").dialog("open");
                return false;
            });
        }
        // update dialog fields with fields from the form
        $(".embed-form .form-field").each(function(){
            $(this).find("input[type='text']").bind("propertychange keyup input paste", function(){
                var id = $(this).attr('id');
                var modalfield = $(".modal-form-wrap .form-field input[id="+id+"]").val($(this).val());
            });
            $(this).find("textarea").bind("propertychange keyup input paste", function(){
                var id = $(this).attr('id');
                var modalfield = $(".modal-form-wrap .form-field textarea[id="+id+"]").val($(this).val());
            });
            $(this).find("select").change(function(){
                var id = $(this).attr('id');
                var modalfield = $(".modal-form-wrap .form-field select[id="+id+"]").val($(this).val());
            });
            $(this).find("input[type='checkbox']").click(function(){
                var id = $(this).attr('id');
                var checked = $(this).is(':checked')
                var modalfield = $(".modal-form-wrap .form-field input[id="+id+"]").prop('checked', checked);
            });
        });
    </script>
{% endblock %}
